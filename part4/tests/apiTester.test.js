const { blogs, seed } = require('./helpers');
const mongoose = require('mongoose');
const supertest = require('supertest');
const app = require('../app');
const api = supertest(app);

const minTimeout = 50000;

beforeAll(async () => {
  await seed();
}, minTimeout);

describe('Get all blogs', () => {
  it(
    'should get all blogs',
    async () => {
      const response = await api
        .get('/api/blogs')
        .expect(200)
        .expect('Content-Type', /application\/json/);
      expect(response.body[0]).toEqual(blogs[0]);
    },
    minTimeout
  );
});

afterAll(async () => {
  await mongoose.connection.close();
});
